<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-simple.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="This is a learning note about Dom, the material is from the web site javascript.info.">
<meta property="og:type" content="article">
<meta property="og:title" content="Document Object">
<meta property="og:url" content="http://yoursite.com/2018/07/31/Dom/index.html">
<meta property="og:site_name" content="Seashore">
<meta property="og:description" content="This is a learning note about Dom, the material is from the web site javascript.info.">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://javascript.info/article/basic-dom-node-properties/dom-class-hierarchy@2x.png">
<meta property="og:image" content="http://javascript.info/article/modifying-document/before-prepend-append-after@2x.png">
<meta property="og:image" content="http://javascript.info/article/modifying-document/insert-adjacent@2x.png">
<meta property="og:image" content="http://javascript.info/article/size-and-scroll/metric-all@2x.png">
<meta property="og:updated_time" content="2018-08-28T14:54:55.260Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Document Object">
<meta name="twitter:description" content="This is a learning note about Dom, the material is from the web site javascript.info.">
<meta name="twitter:image" content="http://javascript.info/article/basic-dom-node-properties/dom-class-hierarchy@2x.png">






  <link rel="canonical" href="http://yoursite.com/2018/07/31/Dom/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Document Object | Seashore</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Seashore</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Categories</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/31/Dom/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chen LuPeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Seashore">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Document Object
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-07-31 13:32:49" itemprop="dateCreated datePublished" datetime="2018-07-31T13:32:49+08:00">2018-07-31</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-08-28 22:54:55" itemprop="dateModified" datetime="2018-08-28T22:54:55+08:00">2018-08-28</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Javascript/" itemprop="url" rel="index"><span itemprop="name">Javascript</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/07/31/Dom/#comments" itemprop="discussionUrl">
                
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2018/07/31/Dom/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>This is a learning note about Dom, the material is from the web site <a href="http://javascript.info/" target="_blank" rel="noopener">javascript.info</a>.</p>
<a id="more"></a>
<h2 id="Document"><a href="#Document" class="headerlink" title="Document"></a>Document</h2><p>Here’s a bird’s-eye view of what we have when JavaScript runs in a web-browser:</p>
<ul>
<li>javascript</li>
<li>DOM (Document Object Model) — The <code>document</code> object gives access to the page content.</li>
<li>BOM (Browser Object Model) — <code>navigator</code> object, <code>location</code> object, <code>history</code> object, <code>XMLHttpRequest</code>, etc.</li>
</ul>
<h3 id="DOM-Tree"><a href="#DOM-Tree" class="headerlink" title="DOM Tree"></a>DOM Tree</h3><p>According to Document Object Model (DOM), <strong>every HTML-tag is an object. The text inside a tag it is an object as well.</strong></p>
<p>Everything in HTML, even comments, becomes a part of the DOM. There are 12 node types. In practice we usually work with 4 of them:</p>
<ol>
<li><code>document</code> – the “entry point” into DOM.</li>
<li>element nodes – HTML-tags, the tree building blocks.</li>
<li>text nodes – contain text.</li>
<li>comments.</li>
</ol>
<h3 id="Walking-the-DOM"><a href="#Walking-the-DOM" class="headerlink" title="Walking the DOM"></a>Walking the DOM</h3><p>Given a DOM node, we can go to its immediate neighbours using navigation properties. There are two main sets of them:</p>
<ul>
<li><p>For <strong>all nodes</strong>: <code>parentNode</code>, <code>childNodes</code>, <code>firstChild</code>, <code>lastChild</code>, <code>previousSibling</code>, <code>nextSibling</code>.</p>
</li>
<li><p>For <strong>element nodes only</strong>: <code>parentElement</code>, <code>children</code>, <code>firstElementChild</code>, <code>lastElementChild</code>,<br><code>previousElementSibling</code>, <code>nextElementSibling</code>.</p>
</li>
</ul>
<p><code>childNodes(children)</code> looks like an array. But actually it’s not an array, but rather a collection – a special array-like iterable object. There are two important consequences:</p>
<ol>
<li><p>We can use <code>for..of</code> to iterate over it. (Don’t use <code>for..in</code> to loop over collections, The <code>for..in</code> loop iterates over all enumerable properties, and return some “extra” rarely used properties that we usually do not want to get).</p>
</li>
<li><p>Array methods won’t work, because it’s not an array. We can use <code>Array.from</code> to create a “real” array from the collection, if we want array methods.</p>
</li>
</ol>
<p>DOM collections are <strong>read-only</strong>; DOM collections are <strong>live</strong>, in other words, they reflect the current state of DOM.</p>
<h3 id="Searching-in-the-DOM"><a href="#Searching-in-the-DOM" class="headerlink" title="Searching in the DOM"></a>Searching in the DOM</h3><table>
<thead>
<tr>
<th>Method</th>
<th style="text-align:center">Searches By…</th>
<th style="text-align:center">Can call on an element</th>
<th style="text-align:center">Live?</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getElementById</code></td>
<td style="text-align:center">id</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td><code>getElementsByTagName</code></td>
<td style="text-align:center">tag</td>
<td style="text-align:center">✔</td>
<td style="text-align:center">✔</td>
</tr>
<tr>
<td><code>getElementsByClassName</code></td>
<td style="text-align:center">class</td>
<td style="text-align:center">✔</td>
<td style="text-align:center">✔</td>
</tr>
<tr>
<td><code>querySelectorAll</code></td>
<td style="text-align:center">CSS-selector</td>
<td style="text-align:center">✔</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td><code>querySelector</code></td>
<td style="text-align:center">CSS-selector</td>
<td style="text-align:center">✔</td>
<td style="text-align:center">-</td>
</tr>
</tbody>
</table>
<p>Please note that methods <code>getElementById</code> and <code>getElementsByName</code> can only be called in the context of the <code>document: document.getElementById(...)</code>.</p>
<p>The call to <code>elem.querySelector(css)</code> returns the first element for the given CSS selector. In other words, the result is the same as <code>elem.querySelectorAll(css)[0]</code>, but the latter is looking for all elements and picking one, while <code>elem.querySelector</code> just looks for one. So it’s faster and shorter to write.</p>
<p>Besides that:</p>
<ul>
<li>There is <code>elem.matches(css)</code> to check if <code>elem</code> matches the given CSS selector.</li>
<li>There is <code>elem.closest(css)</code> to look for the nearest ancestor that matches the given CSS-selector. The <code>elem</code> itself is also checked.</li>
</ul>
<h3 id="Node-Properties"><a href="#Node-Properties" class="headerlink" title="Node Properties"></a>Node Properties</h3><p>Each DOM node belongs to a certain class. The classes form a hierarchy. The full set of properties and methods come as the result of inheritance.</p>
<center><br><img src="http://javascript.info/article/basic-dom-node-properties/dom-class-hierarchy@2x.png" width="65%" height="65%"><br></center>

<p>The innerHTML property allows to get the HTML inside the element as a string, we can also modify it. We can append “more HTML” by using <code>elem.innerHTML+=&quot;something&quot;</code>. <code>innerHTML+=</code> does this:</p>
<ul>
<li>The old contents is removed.</li>
<li>The new innerHTML is written instead.</li>
</ul>
<p>As the content is “zeroed-out” and rewritten from the scratch, all images and other resources will be reloaded. If the existing text was selected with the mouse, then most browsers will remove the selection upon rewriting innerHTML. And if there was an <code>&lt;input&gt;</code> with a text entered by the visitor, then the text will be removed. And so on.</p>
<p>The innerHTML property is only valid for element nodes. Other node types have their counterpart: <code>nodeValue</code> and <code>data</code>(preferred) properties.</p>
<p>The <code>textContent</code> provides access to the text inside the element: only text, minus all <tags>. With <code>innerHTML</code> we’ll have it inserted “as HTML”, with all HTML tags, while with textContent, we’ll have it inserted “as text”, all symbols are treated literally. In most cases, we expect the text from a user, and want to treat it as text. We don’t want unexpected HTML in our site. An assignment to <code>textContent</code> does exactly that.</tags></p>
<p><code>hidden</code> works the same as <code>style=&quot;display:none&quot;</code>. But it’s shorter to write.</p>
<h3 id="Attribute-and-Properties"><a href="#Attribute-and-Properties" class="headerlink" title="Attribute and Properties"></a>Attribute and Properties</h3><p>When the browser loads the page, it parses HTML text and generates DOM objects from it. For element nodes most <strong>standard</strong> HTML attributes automatically become properties of DOM objects. When a standard attribute changes, the corresponding property is auto-updated with some exceptions, e.g., <code>input.value</code> synchronizes only from attribute → to property, but not back. There are some differences bewteen them: the <code>style</code> attribute is a string, but the <code>style</code> property is an object, the <code>href</code> DOM property is always a full URL while the attribute is not.</p>
<p>All attributes(<strong>including nonstandard attribute</strong>) are accessible using following methods:</p>
<ul>
<li>elem.hasAttribute(name) – checks for existence.</li>
<li>elem.getAttribute(name) – gets the value.</li>
<li>elem.setAttribute(name, value) – sets the value.</li>
<li>elem.removeAttribute(name) – removes the attribute.</li>
</ul>
<p>All attributes starting with “data-” are reserved for programmers’ use. They are available in the <code>dataset</code> property. Multiword attributes like <code>data-order-state</code> become camel-cased: <code>dataset.orderState</code>.</p>
<h3 id="Modifying-the-document"><a href="#Modifying-the-document" class="headerlink" title="Modifying the document"></a>Modifying the document</h3><p>Methods to create new nodes:</p>
<ul>
<li><code>document.createElement(tag)</code> – creates an element with the given tag,</li>
<li><code>document.createTextNode(value)</code> – creates a text node (rarely used),</li>
<li><code>elem.cloneNode(deep)</code> – clones the element, if <code>deep==true</code> then with all descendants.</li>
</ul>
<p>Insertion and removal of nodes:</p>
<ul>
<li><p>From the parent:</p>
<ul>
<li><code>parent.appendChild(node)</code></li>
<li><code>parent.insertBefore(node, nextSibling)</code></li>
<li><code>parent.removeChild(node)</code></li>
<li><code>parent.replaceChild(newElem, node)</code></li>
</ul>
<p>All these methods return node.</p>
</li>
<li><p>Given a list of nodes and strings:</p>
<ul>
<li><code>node.append(...nodes or strings)</code> – insert into node, at the end,</li>
<li><code>node.prepend(...nodes or strings)</code> – insert into node, at the beginning,</li>
<li><code>node.before(...nodes or strings)</code> –- insert right before node,</li>
<li><code>node.after(...nodes or strings)</code> –- insert right after node,</li>
<li><code>node.replaceWith(...nodes or strings)</code> –- replace node.</li>
<li><code>node.remove()</code> –- remove the node.</li>
</ul>
<p>Text strings are inserted “as text”.</p>
<center><br><img src="http://javascript.info/article/modifying-document/before-prepend-append-after@2x.png" width="50%" height="50%"><br></center></li>
<li><p>Given a piece of HTML: <code>elem.insertAdjacentHTML(where, html)</code>, inserts depending on where:</p>
<ul>
<li>“beforebegin” – insert html right before elem,</li>
<li>“afterbegin” – insert html into elem, at the beginning,</li>
<li>“beforeend” – insert html into elem, at the end,</li>
<li>“afterend” – insert html right after elem.</li>
</ul>
<p>Also there are similar methods <code>elem.insertAdjacentText</code> and <code>elem.insertAdjacentElement</code>, they insert text strings and elements, but they are rarely used.</p>
<center><br><img src="http://javascript.info/article/modifying-document/insert-adjacent@2x.png" width="50%" height="50%"><br></center>

</li>
</ul>
<h3 id="Styles-and-classes"><a href="#Styles-and-classes" class="headerlink" title="Styles and classes"></a>Styles and classes</h3><p>To manage classes, there are two DOM properties: <code>className</code> and <code>classList</code>.</p>
<p>If we assign something to <code>elem.className</code>, it <strong>replaces</strong> the whole strings of classes. Sometimes that’s what we need, but often we just want to add/remove a single class.</p>
<p>There’s another property for that: <code>elem.classList</code>. The elem.classList is a special object with methods to add/remove/toggle classes. Methods of classList:</p>
<ul>
<li><code>elem.classList.add/remove(&quot;class&quot;)</code> – adds/removes the class.</li>
<li><code>elem.classList.toggle(&quot;class&quot;)</code> – if the class exists, then removes it, otherwise adds it.</li>
<li><code>elem.classList.contains(&quot;class&quot;)</code> – returns true/false, checks for the given class.</li>
</ul>
<p>The property <code>elem.style</code> is an object that corresponds to what’s written in the “style” attribute. For multi-word property the camelCase is used: <code>border-left-width =&gt; elem.style.borderLeftWidth</code>, browser-prefixed properties like <code>-moz-border-radius =&gt;button.style.MozBorderRadius</code>(a dash “-“ becomes an uppercase).</p>
<p>CSS units must be provided in style values. For instance, we should not set <code>elem.style.top</code> to <code>10</code>, but rather to <code>10px</code>, otherwise it wouldn’t work.</p>
<p>Modifying a style is easy. But how to read it? <strong>The style property operates only on the value of the “style” attribute, without any CSS cascade.</strong> There’s another method for that: <code>getComputedStyle</code>. To read the <strong>resolved styles</strong> (with respect to all classes, after all CSS is applied and final values are calculated):</p>
<p><code>The getComputedStyle(elem[, pseudo])</code> returns the style-like object with them. (<strong>Read-only; returns the resolved value; requires the full property name</strong>)</p>
<h3 id="Element-size-and-scrolling"><a href="#Element-size-and-scrolling" class="headerlink" title="Element size and scrolling"></a>Element size and scrolling</h3><p>Elements have the following geometry properties:</p>
<ul>
<li><code>offsetParent</code> – is the nearest positioned ancestor or td, th, table, body.</li>
<li><code>offsetLeft/offsetTop</code> – coordinates relative to the left-upper edge of <code>offsetParent</code>.</li>
<li><code>offsetWidth/offsetHeight</code> – “outer” width/height of an element including borders.</li>
<li><code>clientLeft/clientTop</code> – the distance from the left-upper outer corner to its left-upper inner corner. For left-to-right OS they are always the widths of left/top borders. For right-to-left OS the vertical scrollbar is on the left so clientLeft includes its width too.</li>
<li><code>clientWidth/clientHeight</code> – the width/height of the content including paddings, but without the scrollbar.</li>
<li><code>scrollWidth/scrollHeight</code> – the width/height of the content including the scrolled out parts. Also includes paddings, but not the scrollbar.</li>
<li><code>scrollLeft/scrollTop</code> – width/height of the scrolled out part of the element, starting from its left-upper corner.</li>
</ul>
<p>All properties are read-only except scrollLeft/scrollTop. They make the browser scroll the element if changed.</p>
<center><br><img src="http://javascript.info/article/size-and-scroll/metric-all@2x.png" width="80%"><br></center>

<p>Don’t take width/height from CSS. We can read CSS-height and width using <code>getComputedStyle</code>. Why should we use geometry properties instead? There are two reasons:</p>
<ul>
<li>CSS width/height depend on another property: <code>box-sizing</code>,</li>
<li>CSS width/height may be auto.</li>
</ul>
<p>Some browsers (e.g. Chrome) return the real inner width, minus the scrollbar, and some of them (e.g. Firefox) – CSS width (ignore the scrollbar). Such cross-browser differences is the reason not to use getComputedStyle, but rather rely on geometry properties.</p>
<h3 id="Window-sizes-and-scrolling"><a href="#Window-sizes-and-scrolling" class="headerlink" title="Window sizes and scrolling"></a>Window sizes and scrolling</h3><p>Geometry:</p>
<ul>
<li>Width/height of the visible part of the document (content area width/height):<br><code>document.documentElement.clientWidth/Height</code>.</li>
<li>Width/height of the whole document, with the scrolled out part:<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> scrollHeight = <span class="built_in">Math</span>.max(</span><br><span class="line">  <span class="built_in">document</span>.body.scrollHeight, <span class="built_in">document</span>.documentElement.scrollHeight,</span><br><span class="line">  <span class="built_in">document</span>.body.offsetHeight, <span class="built_in">document</span>.documentElement.offsetHeight,</span><br><span class="line">  <span class="built_in">document</span>.body.clientHeight, <span class="built_in">document</span>.documentElement.clientHeight</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Scrolling:</p>
<p>Most browsers provide <code>documentElement.scrollLeft/Top</code> for the document scroll, but Chrome/Safari/Opera have bugs and we should use <code>document.body</code> instead of <code>document.documentElement</code> there. Luckily, we don’t have to remember these peculiarities at all, because of the following special properties:</p>
<ul>
<li><p>Read the current scroll: <code>window.pageYOffset/pageXOffset</code>.</p>
</li>
<li><p>Change the current scroll:</p>
<ul>
<li><code>window.scrollTo(pageX,pageY)</code> – absolute coordinates,</li>
<li><code>window.scrollBy(x,y)</code> – scroll relative the current place,</li>
<li><code>elem.scrollIntoView(top)</code> – scroll to make elem visible (align with the top/bottom of the window).</li>
</ul>
</li>
</ul>
<h3 id="Coordinates"><a href="#Coordinates" class="headerlink" title="Coordinates"></a>Coordinates</h3><p>Any point on the page has coordinates:</p>
<ul>
<li>Relative to the window – <code>elem.getBoundingClientRect()</code>.</li>
<li>Relative to the document – <code>elem.getBoundingClientRect()</code> plus the current page scroll<br><code>window.pageXOffset/pageYOffset</code>.</li>
</ul>
<p>Window coordinates are great to use with <code>position:fixed</code>, and document coordinates do well with <code>position:absolute</code>.</p>
<p>Both coordinate systems have their “pro” and “contra”, there are times we need one or the other one, just like CSS position absolute and fixed.</p>
<h3 id="Words-and-phrases"><a href="#Words-and-phrases" class="headerlink" title="Words and phrases:"></a>Words and phrases:</h3><ul>
<li>out of nowhere 莫名其妙的出现</li>
<li>superposition 叠加</li>
</ul>

      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/18/Archlinux/" rel="next" title="Arch Linux">
                <i class="fa fa-chevron-left"></i> Arch Linux
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/11/git/" rel="prev" title="Git">
                Git <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Chen LuPeng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">4</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/chenlupeng007" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="chenlupeng233@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Document"><span class="nav-number">1.</span> <span class="nav-text">Document</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DOM-Tree"><span class="nav-number">1.1.</span> <span class="nav-text">DOM Tree</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Walking-the-DOM"><span class="nav-number">1.2.</span> <span class="nav-text">Walking the DOM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Searching-in-the-DOM"><span class="nav-number">1.3.</span> <span class="nav-text">Searching in the DOM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Node-Properties"><span class="nav-number">1.4.</span> <span class="nav-text">Node Properties</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Attribute-and-Properties"><span class="nav-number">1.5.</span> <span class="nav-text">Attribute and Properties</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Modifying-the-document"><span class="nav-number">1.6.</span> <span class="nav-text">Modifying the document</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Styles-and-classes"><span class="nav-number">1.7.</span> <span class="nav-text">Styles and classes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Element-size-and-scrolling"><span class="nav-number">1.8.</span> <span class="nav-text">Element size and scrolling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Window-sizes-and-scrolling"><span class="nav-number">1.9.</span> <span class="nav-text">Window sizes and scrolling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Coordinates"><span class="nav-number">1.10.</span> <span class="nav-text">Coordinates</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Words-and-phrases"><span class="nav-number">1.11.</span> <span class="nav-text">Words and phrases:</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chen LuPeng</span>
<!--
  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Mist</a> v6.3.0</div>



-->

        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.3.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.3.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  

  
    <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
  

  
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'http://yoursite.com/2018/07/31/Dom/';
        this.page.identifier = '2018/07/31/Dom/';
        this.page.title = 'Document Object';
        };
      function loadComments () {
        var d = document, s = d.createElement('script');
        s.src = 'https://.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      }
      
        loadComments();
      
    </script>
  





  





  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
